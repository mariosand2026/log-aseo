<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LOG Â· Artificial Intelligence</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#fff;
  color:#000;
  display:flex;
  justify-content:center;
}
.app{max-width:460px;width:100%;padding:24px;display:none}
header{text-align:center;margin-bottom:20px}
header h1{margin:0;font-size:32px;letter-spacing:2px}
header p{margin:4px 0 0;font-size:12px;color:#666}
.card{border:1px solid #e5e5e5;border-radius:14px;padding:16px;margin-bottom:16px}
textarea,select,input{width:100%;padding:10px;border-radius:10px;border:1px solid #ccc;margin-bottom:10px}
button{width:100%;padding:12px;border:none;border-radius:12px;background:#000;color:#fff;font-weight:600;margin-top:6px}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:6px;margin-top:12px}
.day{border:1px solid #ddd;border-radius:10px;padding:6px;font-size:11px;min-height:70px}
.day strong{display:block;font-size:12px}
.task{margin-top:2px}
.task-config{border:1px dashed #ccc;border-radius:10px;padding:10px;margin-bottom:10px}
footer{text-align:center;font-size:11px;color:#777;margin-top:24px}
#splash{
  position:fixed;inset:0;background:#000;color:#fff;
  display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;
}
</style>
</head>

<body>

<div id="splash">
  <h1 style="font-size:42px;letter-spacing:4px;margin:0">LOG</h1>
  <p style="opacity:.8">Artificial Intelligence</p>
  <p style="opacity:.6;font-size:12px">by Mario AndrÃ©s NarvÃ¡ez Delgado</p>
</div>

<div class="app">
<header><h1>LOG</h1><p>Artificial Intelligence</p></header>

<div class="card">
  <h3>Integrantes</h3>
  <textarea id="members" rows="4" placeholder="Un nombre por lÃ­nea"></textarea>

  <h3>Actividades</h3>
  <div id="taskContainer"></div>
  <button onclick="addTask()">âž• Agregar actividad</button>

  <select id="month"></select>
  <select id="year"></select>

  <button onclick="generateCalendar()">Generar calendario</button>
  <button onclick="generatePDF()">ðŸ“„ Generar PDF</button>
  <button onclick="sendWhatsApp()">ðŸ“² Enviar por WhatsApp</button>
</div>

<div class="card" id="calendarContainer"></div>

<footer>
LOG Â· Artificial Intelligence<br>
by Mario AndrÃ©s NarvÃ¡ez Delgado
</footer>
</div>

<script>
const icons={diaria:"ðŸ§½",semanal8:"ðŸŒ€",quincenal:"ðŸŒ“",mensual:"ðŸ“…"};
const months=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];

const monthSel=document.getElementById("month");
const yearSel=document.getElementById("year");
const taskContainer=document.getElementById("taskContainer");
const calendarContainer=document.getElementById("calendarContainer");

months.forEach((m,i)=>monthSel.innerHTML+=`<option value="${i}">${m}</option>`);
const y=new Date().getFullYear();
for(let i=y-1;i<=y+2;i++)yearSel.innerHTML+=`<option>${i}</option>`;
monthSel.value=new Date().getMonth();
yearSel.value=y;

function addTask(n="",f="diaria"){
  const d=document.createElement("div");
  d.className="task-config";
  d.innerHTML=`<input value="${n}" placeholder="Actividad">
  <select>
    <option value="diaria">Diaria</option>
    <option value="semanal8">Cada 8 dÃ­as</option>
    <option value="quincenal">Quincenal</option>
    <option value="mensual">Mensual</option>
  </select>`;
  d.querySelector("select").value=f;
  taskContainer.appendChild(d);
}

function generateCalendar(){
  const members=document.getElementById("members").value.split('\n').map(x=>x.trim()).filter(Boolean);
  const tasks=[...taskContainer.children].map(t=>({name:t.querySelector("input").value,freq:t.querySelector("select").value})).filter(t=>t.name);
  if(!members.length||!tasks.length)return;

  const days=new Date(yearSel.value,+monthSel.value+1,0).getDate();
  const idx={};tasks.forEach(t=>idx[t.name]=Math.floor(Math.random()*members.length));

  let html=`<h3>${months[monthSel.value]} ${yearSel.value}</h3><div class="calendar">`;
  for(let d=1;d<=days;d++){
    html+=`<div class="day"><strong>${d}</strong>`;
    tasks.forEach(t=>{
      const show=t.freq==="diaria"||(t.freq==="semanal8"&&(d-1)%8===0)||(t.freq==="quincenal"&&(d===1||d===15))||(t.freq==="mensual"&&d===1);
      if(show){
        html+=`<div class="task">${icons[t.freq]} ${t.name} â€“ ${members[idx[t.name]]}</div>`;
        idx[t.name]=(idx[t.name]+1)%members.length;
      }
    });
    html+=`</div>`;
  }
  calendarContainer.innerHTML=html+"</div>";
}
async function generatePDF(){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF("p", "mm", "a4");

  const element = document.getElementById("calendarContainer");

  const canvas = await html2canvas(element, {
    scale: 2,
    useCORS: true
  });

  const imgData = canvas.toDataURL("image/png");

  const pageWidth  = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();

  const imgWidth  = pageWidth;
  const imgHeight = (canvas.height * imgWidth) / canvas.width;

  let finalHeight = imgHeight;

  // ðŸ”‘ Si el contenido es mÃ¡s alto que la pÃ¡gina, lo escalamos
  if (imgHeight > pageHeight) {
    finalHeight = pageHeight;
  }

  pdf.addImage(
    imgData,
    "PNG",
    0,
    0,
    imgWidth,
    finalHeight
  );

  pdf.save("Calendario_Aseo_LOG.pdf");
}

function sendWhatsApp(){
  const msg=encodeURIComponent("Hola ðŸ‘‹ Les comparto el calendario de aseo generado en LOG Â· Artificial Intelligence. AdjuntÃ© el PDF ðŸ“„");
  window.open(`https://wa.me/?text=${msg}`,"_blank");
}

setTimeout(()=>{
  document.getElementById("splash").style.display="none";
  document.querySelector(".app").style.display="block";
},1800);

addTask("Lavar platos","diaria");
addTask("Barrer","semanal8");
addTask("Sacar basura","quincenal");
addTask("Limpieza general","mensual");
</script>
</body>
</html>
